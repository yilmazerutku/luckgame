<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Şans Oyunu</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: darkgrey;
      color: white;
      text-align: center;
      text-shadow: 1px 1px 2px black;
      font-size: 20px;
    }
    #guessB {
      left: 53%;
      top: 50%;
      position: absolute;
      background-color: lightsalmon;
      font-size: 15px;
            width: 150px;

    }
    #diamondB {
      left: 53%;
      top: 53%;
      position: absolute;
      background-color: lightsalmon;
      font-size: 15px;
      width: 150px;
    }

    #reset{
        position: absolute;
        background-color: rgb(137, 128, 240);
        left: 90%;
        top: 95%;
        color: black;
        font-size: 15px;
        width: 150px;


    }


    #infoB {
      left: 1%;
      top: 95%;
      position: absolute;
      background-color: rgb(129, 255, 70);
      font-size: 15px;
      width: 150px;
    }
    #guessT {
      position: absolute;
      background-color: lightblue;
      left: 41%;
      top: 50%;
      color: black;
      font-size: 15px;
    }
    #diamondT {
      position: absolute;
      background-color: lightblue;
      left: 41%;
      top: 53%;
      color: black;
      font-size: 15px;
    }
  </style>
</head>
<body>

  <input id="guessT" type="text" placeholder="Tahminin" />
  <input id="diamondT" type="text" placeholder="Yatırılan Elmas" />
  <button id="reset" onclick="resetOyun()">Sıfırla</button>
  <button id="infoB" onclick="oyunBilgisi()">nasıl oynanır</button>
  <button id="guessB" onclick="TahminiYakala()">Tahmin Yap</button>
  <button id="diamondB" onclick="ElmasMiktariniAyarla()">Elmas Miktarı</button>

  <h1>Şans Oyunu</h1>
  <h5>1 ile 10 Arasında Bir Sayı Tahmin Et</h5>
  <p id="puan"></p>
  <p id="tahminSonucu"></p>
  <p id="yatirilanElmasMiktari"></p>

  <script>
    let puan = 500;
    let yatirilanElmas = 0;
    let dogruTahminSayisi = 0;
    let tahminSayisi = 0;
    let rastgeleSayi = Math.floor(Math.random() * 10) + 1;

    console.log("Tuttuğum sayı (başlangıç):", rastgeleSayi);

    document.getElementById("puan").textContent = "Puan: " + puan;

    function TahminiYakala() {
      const tahmin = parseInt(document.getElementById("guessT").value);

      if (isNaN(tahmin) || tahmin < 1 || tahmin > 10) {
        document.getElementById("tahminSonucu").textContent = "1 ile 10 arasında bir sayı gir.";
        return;
      }

      if (yatirilanElmas < 50) {
        document.getElementById("tahminSonucu").textContent = "En az 50 elmas yatırmalısın.";
        return;
      }

      if (puan < yatirilanElmas) {
        document.getElementById("tahminSonucu").textContent = "Yetersiz puan!";
        return;
      }

      tahminSayisi++;

      if (tahmin === rastgeleSayi) {
        dogruTahminSayisi++;
        let kazanilan = dogruTahminSayisi === 1 ? yatirilanElmas * 5 : Math.floor(yatirilanElmas * 1.5);
        puan += kazanilan;

        console.log("✔️ Doğru tahmin! Tahmin:", tahmin);
        console.log("Kazandığın elmas:", kazanilan);
        console.log("Yeni toplam puan:", puan);

        rastgeleSayi = Math.floor(Math.random() * 10) + 1;
        console.log("Yeni tutulan sayı:", rastgeleSayi);

        tahminSayisi = 0;
        document.getElementById("tahminSonucu").textContent = `Doğru tahmin! Kazandın: ${kazanilan} elmas.`;
      } else {
        dogruTahminSayisi = 0;
        puan -= yatirilanElmas;
        console.log("❌ Yanlış tahmin:", tahmin);
        console.log("Kaybedilen elmas:", yatirilanElmas);
        console.log("Kalan puan:", puan);

        document.getElementById("tahminSonucu").textContent = `Yanlış tahmin (${tahmin}). ${yatirilanElmas} elmas kaybettin.`;
      }

      document.getElementById("puan").textContent = "Puan: " + puan;

      // localStorage'a kaydet
      verileriKaydet();
    }

    function ElmasMiktariniAyarla() {
      const giris = parseInt(document.getElementById("diamondT").value);
      if (isNaN(giris) || giris <= 0) {
        document.getElementById("yatirilanElmasMiktari").textContent = "Geçerli bir elmas miktarı girin.";
        yatirilanElmas = 0;
      } else {
        yatirilanElmas = giris;
        document.getElementById("yatirilanElmasMiktari").textContent = "Yatırılan Elmas: " + yatirilanElmas;
        console.log("Yeni yatırılan elmas miktarı:", yatirilanElmas);
      }

      // localStorage'a kaydet
      verileriKaydet();
    }

    // localStorage işlemleri
    window.onload = function () {
      const kayitliPuan = localStorage.getItem('puan');
      const kayitliYatirilan = localStorage.getItem('yatirilanElmas');
      const kayitliTahminSayisi = localStorage.getItem('tahminSayisi');
      const kayitliSayi = localStorage.getItem('rastgeleSayi');

      if (kayitliPuan !== null) puan = parseInt(kayitliPuan);
      if (kayitliYatirilan !== null) yatirilanElmas = parseInt(kayitliYatirilan);
      if (kayitliTahminSayisi !== null) tahminSayisi = parseInt(kayitliTahminSayisi);
      if (kayitliSayi !== null) rastgeleSayi = parseInt(kayitliSayi);

      console.log("🟡 Oyun yükleniyor...");
      console.log("Kayıtlı puan:", puan);
      console.log("Kayıtlı elmas:", yatirilanElmas);
      console.log("Tuttuğum sayı:", rastgeleSayi);

      document.getElementById("puan").textContent = "Puan: " + puan;
      document.getElementById("yatirilanElmasMiktari").textContent = "Yatırılan Elmas: " + yatirilanElmas;
    };

    function verileriKaydet() {
      localStorage.setItem('puan', puan);
      localStorage.setItem('yatirilanElmas', yatirilanElmas);
      localStorage.setItem('tahminSayisi', tahminSayisi);
      localStorage.setItem('rastgeleSayi', rastgeleSayi);
    }

    // İsteğe bağlı: Sıfırlama fonksiyonu
    function verileriSifirla() {
      localStorage.clear();
      puan = 500;
      yatirilanElmas = 0;
      tahminSayisi = 0;
      rastgeleSayi = Math.floor(Math.random() * 10) + 1;

      console.log("🔁 Veriler sıfırlandı!");
      console.log("Yeni sayı:", rastgeleSayi);

      document.getElementById("puan").textContent = "Puan: " + puan;
      document.getElementById("yatirilanElmasMiktari").textContent = "Yatırılan Elmas: " + yatirilanElmas;
    }

    function resetOyun() {
      if (confirm("Oyunu sıfırlamak istediğinize emin misiniz?")) {
        verileriSifirla();
        document.getElementById("tahminSonucu").textContent = "Oyun sıfırlandı. Yeni bir oyun başladıı.";
      }
    }

    function oyunBilgisi() {
      alert("1 ile 10 arasında bir sayı tahmin et. En az 50 elmas yatırmalısın. İlk doğru tahminde 5 katı kazanırsın, yanlış tahminde yatırdığın elmas kaybolur.");
    }

  </script>
</body>
</html>
